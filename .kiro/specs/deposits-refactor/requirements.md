# מסמך דרישות - ניהול מפקידים והפקדות

## מבוא

מערכת הגמ"ח הנוכחית מטפלת בכל מפקיד כהפקדה בודדת, מה שמקשה על מעקב אחר מפקידים שמוסיפים כסף לאורך זמן. הפיצ'ר החדש יפריד בין מפקידים (אנשים) להפקדות (פעולות כספיות), ויאפשר למפקיד אחד להיות בעל מספר הפקדות נפרדות עם מעקב מלא אחר כל הפקדה ומשיכה.

## מילון מונחים

- **המערכת**: מערכת ניהול הגמ"ח
- **מפקיד**: אדם שמפקיד כסף בגמ"ח
- **הפקדה**: פעולה כספית בודדת של הפקדת כסף על ידי מפקיד
- **משיכה**: פעולה של משיכת כסף מהפקדה ספציפית
- **יתרה פעילה**: סכום הכסף שנמצא כרגע בגמ"ח עבור מפקיד (סכום כל ההפקדות הפעילות פחות משיכות)
- **הפקדה פעילה**: הפקדה שעדיין לא נמשכה במלואה
- **הפקדה שנמשכה**: הפקדה שכל הכסף שלה כבר נמשך

## דרישות

### דרישה 1: ניהול מפקידים

**User Story:** כמנהל גמ"ח, אני רוצה לנהל מפקידים כישויות נפרדות מההפקדות שלהם, כדי שאוכל לעקוב אחר כל מפקיד לאורך זמן.

#### קריטריוני קבלה

1. WHEN המשתמש יוצר מפקיד חדש, THE המערכת SHALL שמור את שם המפקיד, מספר תעודת זהות, טלפון והערות
2. WHEN המשתמש מעדכן פרטי מפקיד, THE המערכת SHALL עדכן את הפרטים ולשמור את השינויים
3. WHEN המשתמש מבקש למחוק מפקיד, IF למפקיד יש הפקדות פעילות, THEN THE המערכת SHALL מנוע את המחיקה ולהציג הודעת שגיאה
4. WHEN המשתמש מבקש למחוק מפקיד, IF למפקיד אין הפקדות פעילות, THEN THE המערכת SHALL מחוק את המפקיד ואת כל ההפקדות וההיסטוריה שלו
5. THE המערכת SHALL הציג רשימה של כל המפקידים עם היתרה הפעילה של כל אחד

### דרישה 2: ניהול הפקדות מרובות למפקיד

**User Story:** כמנהל גמ"ח, אני רוצה שמפקיד אחד יוכל להיות בעל מספר הפקדות נפרדות, כדי שאוכל לעקוב אחר כל הוספת כסף בנפרד.

#### קריטריוני קבלה

1. WHEN המשתמש מוסיף הפקדה חדשה למפקיד קיים, THE המערכת SHALL יצור הפקדה חדשה המקושרת למפקיד
2. WHEN המשתמש מוסיף הפקדה חדשה, THE המערכת SHALL שמור את סכום ההפקדה, תאריך ההפקדה, תקופת ההפקדה, ימי תזכורת, אמצעי תשלום ופרטי תשלום
3. THE המערכת SHALL הציג את כל ההפקדות של מפקיד ממוינות לפי תאריך
4. WHEN המשתמש מבקש לראות פרטי הפקדה, THE המערכת SHALL הציג את כל הפרטים כולל סטטוס (פעילה/נמשכה)
5. THE המערכת SHALL חשב את היתרה הפעילה של כל הפקדה (סכום ההפקדה פחות משיכות)

### דרישה 3: קישור משיכות להפקדות ספציפיות

**User Story:** כמנהל גמ"ח, אני רוצה שכל משיכה תהיה מקושרת להפקדה ספציפית, כדי שאוכל לעקוב בדיוק מאיזו הפקדה נמשך הכסף.

#### קריטריוני קבלה

1. WHEN המשתמש רושם משיכה, THE המערכת SHALL קשר את המשיכה להפקדה ספציפית
2. WHEN המשתמש מבקש לראות משיכות של הפקדה, THE המערכת SHALL הציג את כל המשיכות מההפקדה הזו
3. THE המערכת SHALL חשב את היתרה הנותרת בהפקדה אחרי כל המשיכות
4. WHEN יתרת הפקדה מגיעה לאפס, THE המערכת SHALL סמן את ההפקדה כ"נמשכה"
5. WHEN המשתמש מבקש לראות היסטוריית משיכות של מפקיד, THE המערכת SHALL הציג את כל המשיכות מכל ההפקדות של המפקיד

### דרישה 4: המרת נתונים קיימים

**User Story:** כמנהל גמ"ח, אני רוצה שהמערכת תמיר אוטומטית את הנתונים הקיימים למבנה החדש, כדי שלא אאבד מידע.

#### קריטריוני קבלה

1. WHEN המערכת מזהה נתונים במבנה הישן, THE המערכת SHALL המיר אוטומטית כל הפקדה ישנה למפקיד חדש עם הפקדה אחת
2. WHEN המערכת מבצעת המרה, THE המערכת SHALL שמור את כל הפרטים המקוריים (שם, תעודת זהות, טלפון, סכום, תאריך, וכו')
3. WHEN המערכת מבצעת המרה, THE המערכת SHALL קשר את כל המשיכות הקיימות להפקדות המתאימות
4. WHEN המערכת מסיימת המרה, THE המערכת SHALL הציג הודעה למשתמש על ההמרה המוצלחת
5. THE המערכת SHALL מבצע את ההמרה פעם אחת בלבד בטעינה הראשונה אחרי העדכון

### דרישה 5: חישוב יתרות ודוחות

**User Story:** כמנהל גמ"ח, אני רוצה לראות יתרות מדויקות ודוחות מפורטים, כדי שאוכל לנהל את הגמ"ח בצורה יעילה.

#### קריטריוני קבלה

1. THE המערכת SHALL חשב את היתרה הכוללת של מפקיד (סכום כל ההפקדות הפעילות פחות כל המשיכות)
2. THE המערכת SHALL הציג את מספר ההפקדות הפעילות של כל מפקיד
3. WHEN המשתמש מבקש דוח מפקידים, THE המערכת SHALL הציג רשימה עם שם, תעודת זהות, יתרה פעילה ומספר הפקדות
4. WHEN המשתמש מבקש דוח הפקדות, THE המערכת SHALL הציג את כל ההפקדות עם תאריכים, סכומים ויתרות
5. THE המערכת SHALL חשב את סך כל הכסף בגמ"ח (סכום כל ההפקדות הפעילות פחות כל המשיכות)

### דרישה 6: ממשק משתמש מותאם

**User Story:** כמנהל גמ"ח, אני רוצה ממשק משתמש ברור ונוח, כדי שאוכל לנהל מפקידים והפקדות בקלות.

#### קריטריוני קבלה

1. THE המערכת SHALL הציג דף הפקדות עם רשימת מפקידים במקום רשימת הפקדות
2. WHEN המשתמש לוחץ על מפקיד, THE המערכת SHALL הציג את כל ההפקדות של המפקיד
3. WHEN המשתמש נמצא בתצוגת מפקיד, THE המערכת SHALL הציג כפתור "הפקדה חדשה" להוספת הפקדה למפקיד הקיים
4. THE המערכת SHALL הציג כפתור "מפקיד חדש" ליצירת מפקיד חדש עם הפקדה ראשונה
5. WHEN המשתמש מבקש לערוך מפקיד, THE המערכת SHALL הציג טופס עריכה עם כל הפרטים האישיים של המפקיד
6. THE המערכת SHALL הציג בכרטיס מפקיד את השם, טלפון, יתרה כוללת ורשימת הפקדות עם סטטוס

### דרישה 7: הכנה לאינטגרציה עם מס"ב

**User Story:** כמנהל גמ"ח, אני רוצה לשמור פרטי בנק של מפקידים, כדי שבעתיד אוכל ליצור קבצי מס"ב להחזרת כספים.

#### קריטריוני קבלה

1. THE המערכת SHALL אפשר שמירת קוד בנק, מספר סניף ומספר חשבון עבור כל מפקיד
2. WHEN המשתמש מזין פרטי בנק, THE המערכת SHALL אמת שקוד הבנק הוא מספר בן 2 ספרות
3. WHEN המשתמש מזין פרטי בנק, THE המערכת SHALL אמת שמספר הסניף הוא מספר בן 3 ספרות
4. WHEN המשתמש מזין פרטי בנק, THE המערכת SHALL אמת שמספר החשבון הוא מספר בן עד 9 ספרות
5. THE המערכת SHALL הציג את פרטי הבנק בכרטיס המפקיד אם הם קיימים
